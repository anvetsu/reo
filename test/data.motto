users:tab(['id 'name]
          [til(10)
           ["Hero" "Dunn" "Sue" "Chi"
            "Thor" "Clive" "Hicks" "Devin"
            "Kate" "Klein"]])
friendships:[[0 1] [0 2] [1 2] [1 3] [2 3] [3 4] [4 5] [5 6] [5 7] [6 8] [7 8] [8 9]]

friends:fn(i) truths(map(fn(x) if ( fst(x) = i snd(x)
                                    snd(x) = i fst(x) )
                          friendships))
allfriends:map(friends til(count(users('name))))

"Users with friends" uwf:club(users, tab(['friends] [allfriends]))
names:uwf('name)
cntfrnds:fn(user) { i:pos(names user) count(nth(uwf('friends) i)) }
"Total connections" tcs:sum(map(cntfrnds, names))
"Average connections" avgcns:tcs/count(names)
"User IDs with number of connections" uconns:map(fn(i frnds) [i count(frnds)],
                                                 til(count(names)), uwf('friends))
sorted_uconns:sort(fn(x y) snd(x) > snd(y), uconns)

salaries:[4225 1619 3706 2240 2076 1389 3916 3918 4939 2735]
categories:dec~[3 1 3 2 2 1 3 3 3 2]
rates:[8 5 2]/100.0
cost_for_co:sum(salaries * rates~categories)
"people in category 2 whose salary is less than 4000"
categories = 2 & salaries < 4000
"all salaries in category 2"
sel(categories = 2, salaries)

vs:[22 37 41 19 54 11 34]
vs~sel((vs > 35), til(dim(vs))) "37 41 54"

phrase:"Panama is a canal between Atlantic and Pacific"
sel(phrase = \a til(dim(phrase))) "[1 3 5 10 13 15 29 35 40]"
sel(mem(phrase "aeiouy"), til(count(phrase))) "[1 3 5 7 10 13 15 19 22 23 29 32 35 40 42 44]"

area:[17 50 59 84 89]
discount:[9 8 6 5 4 2]
disc:fn(d) discount(pos(area d))
disc(84) "5"

alph_lower:str_split("abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ")
alph_upper:str_split("ABCDEFGHIJKLMNOPQRSTUVWXYZ ABCDEFGHIJKLMNOPQRSTUVWXYZ*")
tale:str_split("Le Petit Chaperon-Rouge a bouff√© le Loup")
posp:fn(xs x) {i:pos(xs x) if (i = -1 count(xs)
                               i )}
u:fn(c) alph_upper(posp(alph_lower c))
str_join(u~tale)


"turn over in millions" tome:[56 59 67 64 60 61 68 73 78 75 81 84]
growth:fn(xs) 100 * ((dip(1 tome) / dip(-1 tome))-1.0)
growth(tome)

xs:[5 4 10 3]
ys:[8 5 15 9 11 40]
"outer_product" op:fn(opr xs ys) (fn(x) (fn(y) opr(x y))~ys)~xs
op((*) xs ys)

ages:[32 19 50 33 23 65 46 26 31 58 51 23 51 36 28 42 34]
category:[0 25 30 35 45 50 55 65]
rs:op((<) category ages)
cum:count~(truths~rs)
cum-dip(1 cum);0 "[3 2 4 2 2 2 2 0]"
